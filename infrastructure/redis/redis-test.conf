# Redis Test Configuration for Aether Vault
# Optimized for testing environment

# Network Configuration
bind 127.0.0.1
port 6380
protected-mode no

# Security Configuration (disabled for tests)
# requirepass test-redis-2025

# General Configuration
daemonize no
pidfile /tmp/redis-test.pid
loglevel warning
logfile ""

# Database Configuration
databases 4
# Disable persistence for faster tests
save ""
appendonly no

# Memory Management
maxmemory 128mb
maxmemory-policy allkeys-lru

# Persistence Configuration (disabled for tests)
stop-writes-on-bgsave-error yes
rdbcompression no
rdbchecksum no
dbfilename dump-test.rdb
dir /tmp/redis-test/

# AOF Configuration (disabled for tests)
appendonly no

# Client Configuration
timeout 0
tcp-keepalive 0
tcp-backlog 128

# Slow Log Configuration (disabled for tests)
slowlog-log-slower-than -1
slowlog-max-len 0

# Latency Monitoring (disabled for tests)
latency-monitor-threshold -1

# Event Notification (disabled for tests)
notify-keyspace-events ""

# Test Optimizations
hash-max-ziplist-entries 64
hash-max-ziplist-value 32
list-max-ziplist-size -1
list-compress-depth 0
set-max-intset-entries 64
zset-max-ziplist-entries 32
zset-max-ziplist-value 16

# Active Rehashing
activerehashing yes

# Client Output Buffer Limits (minimal for tests)
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 32mb 8mb 60
client-output-buffer-limit pubsub 8mb 2mb 60

# Client Query Buffer Limit
client-query-buffer-limit 128mb

# Protocol Max Bulk Request Size
proto-max-bulk-len 128mb

# Frequency of rehashing
hz 1

# Dynamic HZ
dynamic-hz yes

# Test-specific TTL values (short for fast cleanup)
session:ttl 60            # 1 minute
cache:ttl 30              # 30 seconds
rate-limit:window 30      # 30 seconds
rate-limit:max 10         # Very restrictive for tests
api-cache:ttl 15          # 15 seconds
health:ttl 10             # 10 seconds
metrics:ttl 30            # 30 seconds
security-events:ttl 120   # 2 minutes
domain-verify:ttl 60      # 1 minute
email-verify:ttl 30       # 30 seconds
password-reset:ttl 60     # 1 minute
2fa:ttl 30                # 30 seconds
temp:ttl 10               # 10 seconds
notifications:ttl 60      # 1 minute
search:ttl 15             # 15 seconds
audit:ttl 120             # 2 minutes
perf:ttl 10               # 10 seconds

# Test debugging commands (enabled for debugging)
# rename-command FLUSHDB FLUSHDB_TEST
# rename-command FLUSHALL FLUSHALL_TEST
# rename-command KEYS KEYS_TEST
# rename-command DEBUG DEBUG_TEST

# Test monitoring
# Disable command stats for performance
# CONFIG SET commandstats no

# Test-specific settings
# Allow dangerous commands for testing
# rename-command CONFIG CONFIG_TEST
# rename-command CLIENT CLIENT_TEST

# Test memory optimization
# Lower memory usage for tests
maxmemory-samples 3

# Test connection settings
# Allow fewer connections for tests
maxclients 100

# Test persistence
# Disable saves for faster tests
save ""

# Test logging
# Minimal logging for tests
syslog-enabled no

# Test performance monitoring
# Disable monitoring for performance
latency-monitor-threshold -1

# Test security (disabled)
# Allow dangerous commands for testing
# rename-command SHUTDOWN SHUTDOWN_TEST
# rename-command MODULE MODULE_TEST

# Test clustering (disabled)
# cluster-enabled no

# Test sentinel (disabled)
# port 26380

# Test modules (disabled)
# loadmodule /path/to/redisearch-test.so
# loadmodule /path/to/redisjson-test.so

# Test configuration
# Enable test mode
# test-mode yes

# Test backup configuration
# Disable backups for tests
# save 3600 1

# Test replication (disabled)
# replica-serve-stale-data no
# replica-read-only no

# Test pub/sub
# Enable pub/sub for testing real-time features
# pubsub-mode yes

# Test transactions
# Enable transaction monitoring for tests
# transaction-monitoring yes

# Test Lua scripting
# Enable Lua scripting for custom commands
# lua-time-limit 1000

# Test bitmap operations
# Enable bitmap operations for analytics
# bitmap-enabled yes

# Test hyperloglog
# Enable HyperLogLog for analytics
# hll-enabled yes

# Test geospatial
# Enable geospatial operations
# geo-enabled yes

# Test streams
# Enable Redis Streams for job queues
# streams-enabled yes

# Test modules configuration
# Module-specific test settings
# redisearch:
#   max-results 10
#   timeout 100

# redisjson:
#   max-size 64kb
#   max-depth 10

# redistimeseries:
#   retention 3600
#   max-samples 100

# Test debugging
# Enable debugging features
# debug-enabled yes
# debug-level error
# debug-file /tmp/redis-test-debug.log

# Test profiling
# Disable profiling for performance
# profiling-enabled no

# Test health checks
# Disable health checks for performance
# health-check-enabled no

# Test metrics
# Disable detailed metrics for performance
# metrics-enabled no

# Test alerts
# Disable alerts for performance
# alerts-enabled no

# Test backup
# Disable automatic backups
# backup-enabled no

# Test cleanup
# Enable automatic cleanup for fast test isolation
# cleanup-enabled yes
# cleanup-interval 10
# cleanup-threshold 100

# Test isolation
# Enable test isolation features
# test-isolation yes
# test-cleanup-after-each yes
# test-reset-between-tests yes

# Test performance
# Optimize for test performance
# test-performance-mode yes
# test-fast-startup yes
# test-minimal-logging yes

# Test data management
# Enable test data management
# test-data-cleanup yes
# test-data-isolation yes
# test-data-reset yes

# Test error handling
# Enable test error handling
# test-error-handling yes
# test-error-simulation yes

# Test concurrency
# Enable test concurrency features
# test-concurrency yes
# test-parallel-execution yes
# test-thread-safety yes

# Test validation
# Enable test validation features
# test-validation yes
# test-data-integrity yes
# test-schema-validation yes

# Test monitoring
# Enable test monitoring features
# test-monitoring yes
# test-performance-tracking yes
# test-resource-monitoring yes

# Test security
# Disable test security for performance
# test-security no
# test-authentication no
# test-authorization no

# Test networking
# Optimize test networking
# test-networking yes
# test-connection-pooling yes
# test-load-balancing yes

# Test storage
# Optimize test storage
# test-storage yes
# test-compression no
# test-encryption no

# Test caching
# Optimize test caching
# test-caching yes
# test-cache-invalidation yes
# test-cache-warming no

# Test serialization
# Optimize test serialization
# test-serialization yes
# test-json-serialization yes
# test-binary-serialization no

# Test transactions
# Enable test transaction features
# test-transactions yes
# test-transaction-rollback yes
# test-transaction-isolation yes

# Test locks
# Enable test locking features
# test-locks yes
# test-distributed-locks yes
# test-lock-timeout 1000

# Test queues
# Enable test queue features
# test-queues yes
# test-job-queues yes
# test-message-queues yes

# Test events
# Enable test event features
# test-events yes
# test-event-bus yes
# test-event-handling yes

# Test streams
# Enable test stream features
# test-streams yes
# test-data-streams yes
# test-event-streams yes

# Test pub/sub
# Enable test pub/sub features
# test-pubsub yes
# test-message-broker yes
# test-event-dispatcher yes

# Test search
# Enable test search features
# test-search yes
# test-full-text-search yes
# test-indexing yes

# Test analytics
# Enable test analytics features
# test-analytics yes
# test-metrics-collection yes
# test-performance-analytics yes

# Test logging
# Optimize test logging
# test-logging yes
# test-structured-logging yes
# test-log-level error

# Test debugging
# Enable test debugging features
# test-debugging yes
# test-breakpoints yes
# test-step-through yes

# Test profiling
# Enable test profiling features
# test-profiling yes
# test-performance-profiling yes
# test-memory-profiling yes

# Test benchmarking
# Enable test benchmarking features
# test-benchmarking yes
# test-load-testing yes
# test-stress-testing yes

# Test validation
# Enable test validation features
# test-validation yes
# test-input-validation yes
# test-output-validation yes

# Test error handling
# Enable test error handling features
# test-error-handling yes
# test-exception-handling yes
# test-error-recovery yes

# Test recovery
# Enable test recovery features
# test-recovery yes
# test-data-recovery yes
# test-service-recovery yes

# Test backup
# Disable test backup features
# test-backup no
# test-data-backup no
# test-config-backup no

# Test restore
# Enable test restore features
# test-restore yes
# test-data-restore yes
# test-config-restore yes

# Test migration
# Enable test migration features
# test-migration yes
# test-data-migration yes
# test-schema-migration yes

# Test deployment
# Enable test deployment features
# test-deployment yes
# test-service-deployment yes
# test-config-deployment yes

# Test scaling
# Enable test scaling features
# test-scaling yes
# test-horizontal-scaling yes
# test-vertical-scaling yes

# Test monitoring
# Enable test monitoring features
# test-monitoring yes
# test-health-monitoring yes
# test-performance-monitoring yes

# Test alerting
# Disable test alerting features
# test-alerting no
# test-health-alerting no
# test-performance-alerting no

# Test reporting
# Enable test reporting features
# test-reporting yes
# test-test-reporting yes
# test-performance-reporting yes

# Test documentation
# Enable test documentation features
# test-documentation yes
# test-api-documentation yes
# test-test-documentation yes